
## 규칙 17. 계승을 위한 설계와 문서를 갖추거나, 그럴 수 없다면 계승을 금지하라.

### 1. 재정의 가능 메서드를 내부적으로 어떻게 사용하는지 반드시 문서에 남겨라..!
  - public, protected로 선언된 애들은 재정의 가능 메서드를 어떤 순서로 호출하는지, 그리고 결과가 추후 어떤 영향을 미치는지 문서로 남겨라..!
    - 즉, 재정의 가능 메서드가 호출되는 모든 상황을 문서로 남기라..!
  - 예시 : remove

### 2. 클래스 내부 동작에 개입할 수 있는 훅을 신중하게 골라, protected 메소드로 제공하는 방법도 있다.
  ``` JAVA
  protected void removeRange(int fromIndex, int toIndex)
  ```
  - 이 메서드를 재정의해서 리스트 구현체의 내부 구현을 활용하면 clear 성능을 꽤 높일 수 있다.
  - protected 멤버는 가능한 줄이자..! 근데, 너무 적지 않은가도 주의해야한다..!(계승해서 쓰기에 형편없을 수 있어서..!)

### 3. 계승을 위해 설계한 클래스를 테스트할 유일한 방법은 하위 클래스를 직접 만들어 보는 것이다.

### 4. 계승을 허용하려면 따라야 할 제약사항..!
  - 생성자는 직접적이건 간접적이건 재정의 가능 메서드를 호출하면 안된다.
  ``` JAVA
  public  class S {
    public S() {
      om();
    }

    public void om(){

    }
  }

  public final class Sub extends S {
    @Override public void om(){
      System.out.println("kkd");
    }

    public static void main(String args[]){
      Sub s = new Sub();
      sub.om();
    }
  }
  ```

  - Cloneable, Serializable 계승할때..
    - clone이나 readObject 메서드 안에서 재정의 가능한 메서드를 호출하지 않도록 주의하라..
    - readObject 메서드 안에서 재정의 가능 메서드를 호출하게 되면, 하위 클래스의 상태가 완전히 deserialize 되기 전에 해당 메서드가 실행 된다.
    - clone 의 경우에는 하위 클래스의 clone 메서드가 복사본 객체의 상태를 미처 수정하기도 전에, 해당 메서드가 실행되어 버릴 것이다. 이 오류는 복사본뿐 아니라 원래 객체까지도 망가뜨린다. 예를 들어 재정의 된 메서드가 clone 이 만들어낸 복사본의 내부 구조 깊은 곳까지 건드릴 경우를 생각해보면, 복사본은 채 완성되지 않은 상태임을 알 수 있다.
    -  `Serializable` 을 구현하는 계승 클래스에서 `readResolve` 와 `writeReplace` 메서드가 있다면, 반드시 `protected` 로 선언해야 한다. (private 가 아니라) `private` 로 선언해 버리면 하위 클래스는 해당 메서드를 조용히 무시한다.

  - 계승을 위해 클래스를 설계하면 제약이 가해지는데, 추상클래스나 인터페이스에 대한 골격구현이면 올바른 결정일 것이다.
    - 변경 불가능 객체라면 계승 배제

### 5. 계승에 맞도록 설계하고 문서화하지 않은 클래스에 대한 하위 클래스는 만들지 않는 것이다.
  - 하위 클래스 생성 금지를 위한 방법
    - 클래스를 `final` 로 선언
    - 모든 생성자를 `private` 이나 `package-private` 로 선언하고 생성자 대신 `public` 정적 팩토리를 추가

  - 일반적으로 기능 추가를 위해 일반 클래스를 상속해서 사용하는데, 이 경우 계승 대신 **wrapper class** 를 사용하는 것이 낫다. 만약 계승을 반드시 
허용해야 한다면, 재정의 가능 메서드는 절대로 호출하지 않도록 하고, 그 사실을 반드시 문서에 남겨야 한다.

  - 재정의 가능 메서드를 기계적으로 제거하는 방법은, 재정의 가능 메서드의 내부 코드를 `private` 로 선언된 헬퍼 메소드로 옮기고,
각각의 재정의 가능 메서드가 헬퍼 메서드를 호출하게 하면 된다.
